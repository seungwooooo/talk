<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.douzone.comet.service.qm.qmireq.x20124.dao.QMIREQ00100_X20124_DAO">
	<select id="list_mst" parameterType="hashmap" resultType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst">
		SELECT TESTREQ.COMPANY_CD
			 , TESTREQ.PLANT_CD			-- 공장코드
			 , TESTREQ.ISPC_REQN_DT 	-- 검사요청일
			 , TESTREQ.ISPC_REQN_NO		-- 검사요청번호
			 , TESTREQ.ISPC_REQN_SQ		-- 검사요청순번
			 , TESTREQ.ISPC_FG_CD		-- 검사용도
			 , TESTREQ.RULE_CD			-- 채번규칙
			 , TESTREQ.ORD_NO			-- 오더번호
			 , TESTREQ.ORD_SQ			-- 오더순번
			 , TESTREQ.PARTNER_CD		-- 거래처
			 , CPARTNER.PARTNER_NM 		-- 거래처명
			 , TESTREQ.ITEM_CD			-- 품목코드
			 , CITEM.ITEM_NM 			-- 품목명
			 , MITEM.ITEM_GRP_CD		-- 품목그룹코드
			 , ITEMGRP.ITEM_GRP_NM		-- 품목그룹명
			 , CITEM.STD_UNIT_CD		-- 품목단위
			 , TESTREQ.BATCH_NO			-- Batch 번호
			 , MITEM.BATCH_STD_CD		-- 배치기준코드
			 , TESTREQ.REQN_QT			-- 요청수량
			 , TESTREQ.SAMP_QT			-- 샘플수량
			 , TESTREQ.ISPC_UNIT_CD		-- 샘플단위
			 , TESTREQ.ISPC_REQN_EMP_CD -- 검사요청자
			 , EMP1.KOR_NM AS ISPC_REQN_EMP_NM
			 , TESTREQ.RMK_DC 			-- 비고
			 , TESTREQ.OP_CD_FG			-- 공정약어
			 , TESTREQ.MNFC_LINE_CD 	-- 제조라인코드
			 , TESTREQ.SAMPLE_FG 		-- 바이오버든
			 , TESTREQ.NEXT_ISPC_FG_CD 	-- 원료재시험기준
			 , TESTREQ.VLID_TERM_TXT	-- 원료재시험개월수
			 , TESTREQ.WRK_DTS			-- 검사채취일시
			 , TO_CHAR(TESTREQ.WRK_DTS, 'yyyyMMdd') AS WRK_DT	-- 검사채취일
			 , TO_CHAR(TESTREQ.WRK_DTS, 'HH24miss') AS WRK_TM	-- 검사채취시간
			 , TESTREQ.ISPC_EMP_CD 		-- 검사채취사원
			 , EMP2.KOR_NM AS ISPC_EMP_NM
			 , TESTREQ.MTL_RTUN_YN		-- 금속불출여부
			 , TESTREQ.ITEM_MTRQLT_DC	-- 기준규약
			 , TESTREQ.STOR_COND_CD		-- 보관조건코드
			 , MC.SYSDEF_NM AS STOR_COND_NM		-- 보관조건
			 , PROD.PROD_TP_CD
		FROM QM_TESTREQ_INFO_X20124 TESTREQ
		LEFT OUTER JOIN CI_PARTNER_MST CPARTNER
			ON CPARTNER.PARTNER_CD = TESTREQ.PARTNER_CD
		LEFT OUTER JOIN CI_ITEM CITEM
			ON CITEM.ITEM_CD = TESTREQ.ITEM_CD
		LEFT OUTER JOIN MA_ITEM MITEM
			ON MITEM.COMPANY_CD = TESTREQ.COMPANY_CD
		   AND MITEM.ITEM_CD	= TESTREQ.ITEM_CD
		LEFT OUTER JOIN MA_ITEMGRP_INFO ITEMGRP
			ON ITEMGRP.COMPANY_CD  = TESTREQ.COMPANY_CD
		   AND ITEMGRP.ITEM_GRP_CD = MITEM.ITEM_GRP_CD
		LEFT OUTER JOIN HR_EMP_MST EMP1
			ON EMP1.COMPANY_CD = TESTREQ.COMPANY_CD
		   AND EMP1.EMP_NO	   = TESTREQ.ISPC_REQN_EMP_CD
		LEFT OUTER JOIN HR_EMP_MST EMP2
			ON EMP2.COMPANY_CD = TESTREQ.COMPANY_CD
		   AND EMP2.EMP_NO	   = TESTREQ.ISPC_EMP_CD
		LEFT OUTER JOIN MA_CODEDTL MC
			ON MC.COMPANY_CD = TESTREQ.COMPANY_CD
		   AND MC.MODULE_CD  = 'QM'
		   AND MC.FIELD_CD   = 'Z010_20124'
		   AND MC.SYSDEF_CD  = TESTREQ.STOR_COND_CD
		LEFT OUTER JOIN PP_PROD_MST PROD
			ON PROD.COMPANY_CD = TESTREQ.COMPANY_CD
		   AND PROD.PROD_NO	   = TESTREQ.ORD_NO
		   AND PROD.PROD_SQ	   = TESTREQ.ORD_SQ
		WHERE TESTREQ.COMPANY_CD 		 = #{P_COMPANY_CD}
			AND TESTREQ.PLANT_CD		 = #{P_PLANT_CD}
			AND TESTREQ.ISPC_REQN_DT 	 = #{P_ISPC_REQN_DT}
			AND TESTREQ.ISPC_REQN_EMP_CD = #{P_ISPC_REQN_EMP_CD}
			AND TESTREQ.ISPC_FG_CD		 = #{P_ISPC_FG_CD}
		ORDER BY TESTREQ.ISPC_REQN_NO
	</select>
	
	<select id="check_testreq" parameterType="hashmap" resultType="int">
		SELECT COUNT(*)
		FROM QM_TESTREQ_INFO_X20124 TESTREQ
		WHERE TESTREQ.COMPANY_CD	= #{P_COMPANY_CD}
			AND TESTREQ.PLANT_CD	= #{P_PLANT_CD}
			AND TESTREQ.ISPC_REQN_NO LIKE #{P_ISPC} || '%'
	</select>
	
	<select id="max_testreq" parameterType="hashmap" resultType="string">
		SELECT MAX(ISPC_REQN_NO)
		FROM QM_TESTREQ_INFO_X20124 TESTREQ
		WHERE TESTREQ.COMPANY_CD	= #{P_COMPANY_CD}
			AND TESTREQ.PLANT_CD	= #{P_PLANT_CD}
			AND TESTREQ.ISPC_REQN_NO LIKE #{P_ISPC} || '%'
	</select>
	
	<select id="select_stor_cond_cd" parameterType="hashmap" resultType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst">
		SELECT C.SYSDEF_CD AS STOR_COND_CD
			 , C.SYSDEF_NM AS STOR_COND_NM
			 , B.MENU_ID 
		FROM MA_PITEM A
		INNER JOIN MA_MENUADDCOL_INFO  B
			ON B.COMPANY_CD    =  A.COMPANY_CD
		   AND B.RECORD_KEY_VR = CONCAT(CONCAT(CONCAT(A.COMPANY_CD, '|'), CONCAT(A.PLANT_CD, '|')), A.ITEM_CD)
	--	   AND B.MENU_ID	   = 'COMITM00200'
		   AND B.FIELD_ID	   = 'FIELD_1'
		INNER JOIN MA_CODEDTL  C
			ON C.COMPANY_CD = B.COMPANY_CD
		   AND C.MODULE_CD  = 'QM'
		   AND C.FIELD_CD   = 'Z010_20124'
		   AND C.SYSDEF_CD  = B.FIELD_VAL_TXT
		WHERE A.COMPANY_CD = #{P_COMPANY_CD}
		  AND A.PLANT_CD    = #{P_PLANT_CD}
		  AND A.ITEM_CD    = #{P_ITEM_CD}
		  AND B.MENU_ID = 
		  CASE WHEN 
		  (
		   SELECT MMI.FIELD_VAL_TXT
		   FROM MA_MENUADDCOL_INFO MMI
		   WHERE MMI.COMPANY_CD = A.COMPANY_CD
		     AND MMI.RECORD_KEY_VR = CONCAT(CONCAT(CONCAT(A.COMPANY_CD, '|'), CONCAT(A.PLANT_CD, '|')), A.ITEM_CD)
		     AND MMI.MENU_ID	= 'COMITM00200'
		     AND MMI.FIELD_ID	= 'FIELD_1'
		  ) IS NULL THEN 'COMITM01000'
			  	    ELSE 'COMITM00200'
		  END
	</select>
	
	<select id="select_purrcv" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst" resultType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst">
		SELECT CNSTRC_ITEM_SPEC_DC AS PRINT_QT 		-- 출력매수
			 , RCPT_PROC_DT	AS VLID_TERM_TXT		-- 가입고일자
		FROM PU_PURRCV_DTL
		WHERE COMPANY_CD = #{company_cd}
		  AND RCPT_NO 	 = #{ord_no}
		  AND RCPT_SQ 	 = #{ord_sq}
	</select>
	
	<select id="select_lo" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst" resultType="hashmap">
		SELECT CASE WHEN A_VAL IS NULL
			   THEN C_VAL ELSE A_VAL END AS MNFC_DT			-- LOD.CHRTR_CD IN ('1000','4000')
			 , CASE WHEN B_VAL IS NULL 
			   THEN D_VAL ELSE B_VAL END AS FLOW_TMLMT_DT	-- LOD.CHRTR_CD IN ('2000','5000')
			 , E_VAL AS MNFC_NO								-- LOD.CHRTR_CD = '6000'						
		FROM (
		SELECT LOD.CHRTR_VAL_NM
			 , LOD.CHRTR_CD
		--	 , LOD.* 
		FROM LO_OBJECTCLASS_DTL LOD
		WHERE  LOD.OBJECT1_CD = #{company_cd}
		   AND LOD.OBJECT2_CD = #{batch_no}
		   AND LOD.OBJECT3_CD = #{item_cd}
		)
		PIVOT 
		(
			MAX(CHRTR_VAL_NM) AS VAL
			FOR CHRTR_CD IN ('1000' AS A, '2000' AS B, '4000' AS C, '5000' AS D, '6000' AS E)
		)
	</select>

	
	<select id="select_deptRmk" parameterType="hashmap" resultType="string">
		SELECT DEPT.RMK1_DC
		--	 , EMP.COMPANY_CD
		--	 , EMP.EMP_NO
		--	 , EMP.KOR_NM
		--	 , EMP.DEPT_CD
		--	 , DEPT.DEPT_CD
		FROM HR_EMP_MST EMP
		LEFT OUTER JOIN MA_DEPT_MST DEPT
			ON DEPT.COMPANY_CD = EMP.COMPANY_CD 
		   AND DEPT.DEPT_CD	   = EMP.DEPT_CD
		WHERE EMP.COMPANY_CD   = #{P_COMPANY_CD}
			AND EMP.EMP_NO 	   = #{P_EMP_NO}
	</select>
		
	<select id="check_testrule" parameterType="hashmap" resultType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_testrule">
		SELECT RULEDTL.COMPANY_CD
			 , RULEDTL.RULE_CD
			 , RULEDTL.RULE_SQ
			 , RULEDTL.CD_FG
			 , RULEDTL.CD_TP
			 , RULEDTL.LOCATION_SQ
			 , RULEDTL.START_LEN_CNT
			 , RULEDTL.END_LEN_CNT
			 , RULEDTL.SETUP_VR
			 , RULEDTL.INC_UNIT_CNT
			 , RULEDTL.RMK_DC
		FROM QM_TESTRULE_DTL_X20124 RULEDTL
		WHERE RULEDTL.COMPANY_CD = #{P_COMPANY_CD}
			AND RULEDTL.RULE_CD = #{P_RULE_CD}
		ORDER BY LOCATION_SQ
	</select>
	
	<insert id="insert_mst" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst"> 
		 INSERT INTO QM_TESTREQ_INFO_X20124 TESTREQ
		(
		    COMPANY_CD, ISPC_REQN_DT, ISPC_REQN_NO, ISPC_PRGR_ST, ISPC_REQN_SQ, ISPC_FG_CD, RULE_CD, PLANT_CD, ORD_NO, ORD_SQ, PARTNER_CD, ITEM_CD, 
		    BATCH_NO, REQN_QT, SAMP_QT, ISPC_REQN_EMP_CD, RMK_DC, OP_CD_FG, MNFC_LINE_CD, SAMPLE_FG, NEXT_ISPC_FG_CD, VLID_TERM_TXT, 
		    WRK_DTS, ISPC_EMP_CD, MTL_RTUN_YN, INSERT_ID, INSERT_DTS, ISPC_UNIT_CD, STD_UNIT_CD, ITEM_MTRQLT_DC, STOR_COND_CD, PRINT_QT, 
		    MNFC_DT, FLOW_TMLMT_DT, MNFC_NO, MKCO_NM
		)
		VALUES
		(
		    #{company_cd}, #{ispc_reqn_dt}, #{ispc_reqn_no}, '0',
		    (
		     SELECT COALESCE(MAX(ISPC_REQN_SQ)+1,1) 
		     FROM QM_TESTREQ_INFO_X20124 
		     WHERE COMPANY_CD = #{company_cd} 
		       AND PLANT_CD = #{plant_cd} 
		       AND ISPC_REQN_NO = #{ispc_reqn_no}
		     ), 
		    #{ispc_fg_cd}, #{rule_cd}, #{plant_cd}, #{ord_no}, #{ord_sq}, #{partner_cd}, #{item_cd}, #{batch_no}, #{reqn_qt}, #{samp_qt}, #{ispc_reqn_emp_cd}, #{rmk_dc},
		    #{op_cd_fg}, #{mnfc_line_cd}, #{sample_fg}, #{next_ispc_fg_cd}, #{vlid_term_txt}, #{wrk_dts}, #{ispc_emp_cd}, #{mtl_rtun_yn}, #{insert_id}, #{insert_dts},
		    #{ispc_unit_cd}, #{std_unit_cd}, #{item_mtrqlt_dc}, #{stor_cond_cd}, #{print_qt},
		    #{mnfc_dt}, #{flow_tmlmt_dt}, #{mnfc_no}, #{mkco_nm}
		)
	</insert>
	
	<insert id="insert_mst_if" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00200_X20124_mst"> 
		 INSERT INTO QM_TESTREQ_IF_X20124 TESTREQ_IF
		(
		    INTL_SYS_CD, INTL_HIS_SQ, SEND_RCV_FG, RELATION_CD, CRUD_FG, UPDATE_POSS_YN, INTL_ST, INTL_DTS, 
		    COMPANY_CD, ISPC_REQN_DT, ISPC_REQN_NO, ISPC_REQN_SQ, ISPC_PRGR_ST, ISPC_FG_CD, RULE_CD, PLANT_CD, ORD_NO, ORD_SQ, PARTNER_CD, ITEM_CD, 
		    BATCH_NO, REQN_QT, SAMP_QT, ISPC_REQN_EMP_CD, RMK_DC, OP_CD_FG, MNFC_LINE_CD, SAMPLE_FG, NEXT_ISPC_FG_CD, VLID_TERM_TXT, 
		    WRK_DTS, ISPC_EMP_CD, MTL_RTUN_YN, INSERT_ID, INSERT_DTS, ISPC_UNIT_CD, STD_UNIT_CD, ITEM_MTRQLT_DC, STOR_COND_CD,
		    MNFC_DT, FLOW_TMLMT_DT, MNFC_NO, MKCO_NM
		)
		VALUES
		(
		    'LIMS',
		    (SELECT COALESCE(MAX(INTL_HIS_SQ)+1,0) FROM QM_TESTREQ_IF_X20124
		     WHERE INTL_SYS_CD = 'LIMS'),
		     '1', '810', 'I', 'Y', '1', SYSDATE,
		    #{company_cd}, #{ispc_reqn_dt}, #{ispc_reqn_no}, 
		    (
		     SELECT COALESCE(MAX(ISPC_REQN_SQ),1) 
		     FROM QM_TESTREQ_INFO_X20124 
		     WHERE COMPANY_CD = #{company_cd} 
		       AND PLANT_CD = #{plant_cd} 
		       AND ISPC_REQN_NO = #{ispc_reqn_no}
		    ), 
		    '0', #{ispc_fg_cd}, #{rule_cd}, #{plant_cd}, #{ord_no}, #{ord_sq}, #{partner_cd}, #{item_cd}, #{batch_no}, #{reqn_qt}, #{samp_qt}, #{ispc_reqn_emp_cd}, #{rmk_dc},
		    #{op_cd_fg}, #{mnfc_line_cd}, #{sample_fg}, #{next_ispc_fg_cd}, #{vlid_term_txt}, #{wrk_dts}, #{ispc_emp_cd}, #{mtl_rtun_yn}, #{insert_id}, #{insert_dts},
		    #{ispc_unit_cd}, #{std_unit_cd}, #{item_mtrqlt_dc}, #{stor_cond_cd},
		    #{mnfc_dt}, #{flow_tmlmt_dt}, #{mnfc_no}, #{mkco_nm}
		)
	</insert>
	
	<update id="update_purrcv_dtl" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst"> 
		UPDATE PU_PURRCV_DTL
		SET BATCH_NO = #{ispc_reqn_no},
		       UPDATE_ID = #{update_id},
		       UPDATE_DTS = #{update_dts}
		WHERE COMPANY_CD = #{company_cd}
		AND RCPT_NO = #{ord_no}
		AND RCPT_SQ = #{ord_sq}
	</update>

	<update id="update_ocmst" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst"> 
		UPDATE LO_OBJECTCLASS_MST
		SET OBJECT2_CD = #{ispc_reqn_no},
		    UPDATE_ID = #{update_id},
		    UPDATE_DTS = #{update_dts}
		WHERE COMPANY_CD = #{company_cd}
		AND CLASS_TP	 = '1000'
		AND OBJECT1_CD = #{company_cd}
		AND OBJECT2_CD = #{batch_no}
		AND OBJECT3_CD = #{item_cd}
	</update>
	
	<update id="update_ocdtl" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst"> 
		UPDATE LO_OBJECTCLASS_DTL
		SET OBJECT2_CD = #{ispc_reqn_no},
		       UPDATE_ID = #{update_id},
		       UPDATE_DTS = #{update_dts}
		WHERE COMPANY_CD = #{company_cd}
		AND OBJECT1_CD = #{company_cd}
		AND OBJECT2_CD = #{batch_no}
		AND OBJECT3_CD = #{item_cd}
	</update>
	
	<update id="update_bi_info" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst"> 
		UPDATE LO_BATCHITEM_INFO
		SET BATCH_NO = #{ispc_reqn_no},
		    UPDATE_ID = #{update_id},
		    UPDATE_DTS = #{update_dts}
		WHERE COMPANY_CD = #{company_cd}
		AND BATCH_NO = #{batch_no}
		AND ITEM_CD = #{item_cd}
	</update>
	
	<update id="update_bb_info" parameterType="com.douzone.comet.service.qm.qmireq.x20124.models.QMIREQ00100_X20124_mst"> 
		UPDATE LO_BATSTDBATCH_INFO
		SET BATCH_NO = #{ispc_reqn_no},
		    UPDATE_ID = #{update_id},
		    UPDATE_DTS = #{update_dts}
		WHERE COMPANY_CD = #{company_cd}
		AND BATCH_NO = #{batch_no}
		AND BATCH_STD_CD = #{batch_std_cd}
	</update>
	
	<select id="addinfo_val" parameterType="hashmap" resultType="hashmap">
		<if test="P_TABLE_ID_LIST != null and P_TABLE_ID_LIST.size != 0">
			WITH PU_PURORDER_DTL_T	AS 
			(
				<include refid="com.douzone.comet.service.ma.common.MaMenuAddInfoService.join_MENUADDCOL_INFO"></include>
			)
		</if>
		SELECT T.*
		<!-- 메뉴별 부가정보 필드 추가 -->
		<if test="P_TABLE_ID_LIST != null and P_TABLE_ID_LIST.size != 0">
			<foreach item="item" index="index" collection="P_TABLE_ID_LIST">
				<if test='item != null and item eq "PU_PURORDER_DTL"'>
					,PU_PURORDER_DTL_T.*
				</if>
			</foreach>
		</if>
		FROM 
		(
			<if test="P_ISPC_FG_CD == '03'">
			SELECT PROD.COMPANY_CD
				 , PROD.PROD_NO				-- 생산지시
				 , PROD.PROD_SQ
				 , PROD.PROD_TP_CD
				 , PURMST.PARTNER_CD
				 , CP.PARTNER_NM
				 , PURDTL.PURDOC_NO			-- 발주번호
				 , PURDTL.PURDOC_SQ
				 , PURDTL.PO_CNCL_YN
				 , PROD.PROD_TP_CD
				 , TPPRD.PROD_TP_NM
			FROM PU_PURORDER_DTL PURDTL
			INNER JOIN PU_PURORDER_MST PURMST
				ON PURMST.COMPANY_CD = PURDTL.COMPANY_CD
			   AND PURMST.PURDOC_NO  = PURDTL.PURDOC_NO
			INNER JOIN PU_PURORDERACCT_DTL PURACCT
				ON PURACCT.COMPANY_CD = PURDTL.COMPANY_CD
			   AND PURACCT.PURDOC_NO = PURDTL.PURDOC_NO
			   AND PURACCT.PURDOC_SQ = PURDTL.PURDOC_SQ
			INNER JOIN PP_PROD_MST PROD
				ON PROD.COMPANY_CD = PURACCT.COMPANY_CD
			   AND PROD.PROD_NO	   = PURACCT.PROD_NO
			   AND PROD.PROD_SQ	   = PURACCT.PROD_SQ
			INNER JOIN CI_PARTNER_MST CP
				ON CP.PARTNER_CD = PURMST.PARTNER_CD
			LEFT OUTER JOIN PP_TPPRDORD_MST TPPRD
				ON TPPRD.COMPANY_CD	= PROD.COMPANY_CD
			   AND TPPRD.PROD_TP_CD = PROD.PROD_TP_CD
			WHERE PROD.COMPANY_CD = #{P_COMPANY_CD}
				AND PROD.PROD_NO  = #{P_ORD_NO}
				AND PROD.PROD_SQ  = #{P_ORD_SQ}
				AND COALESCE(PURDTL.PO_CNCL_YN, ' ')  != 'Y' 
			</if>
			<if test="P_ISPC_FG_CD == '04' or P_ISPC_FG_CD == '05'">
			SELECT PURRCV.PURDOC_NO
				 , PURRCV.PURDOC_SQ
			FROM PU_PURRCV_DTL PURRCV
			WHERE PURRCV.COMPANY_CD = #{P_COMPANY_CD}
				AND PURRCV.RCPT_NO 	= #{P_ORD_NO}
				AND PURRCV.RCPT_SQ 	= #{P_ORD_SQ}
				AND COALESCE(PURRCV.CNCL_YN , ' ')  != 'Y' 
			</if>
		) T
		<!-- 메뉴별 부가정보 조인 처리 -->
		<if test="P_TABLE_ID_LIST != null and P_TABLE_ID_LIST.size != 0">
			<foreach item="item" index="index" collection="P_TABLE_ID_LIST">
				<if test='item != null and item eq "PU_PURORDER_DTL"'>
					LEFT OUTER JOIN PU_PURORDER_DTL_T ON PU_PURORDER_DTL_T.RECORD_KEY_VR = T.PURDOC_NO || '|' || T.PURDOC_SQ
				</if>
			</foreach>
		</if>
	</select>
</mapper>
